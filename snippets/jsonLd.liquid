{%- assign reviewRating = product.metafields.judgeme.badge | split: "data-average-rating='" | last | split: "'" |first | plus: 0 -%}
{%- assign reviewCount = product.metafields.judgeme.badge | split: "data-number-of-reviews='" | last | split: "'" |first | plus: 0 -%}
<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Product",
  "name": "{{ product.title }}",
  "description": "{{ product.metafields.info.shortdesc | default: product.description | strip_html | escape}}",
  "image": "{{ product.featured_image | image_url: width: 300 }}",
  "brand": {
    "@type": "Brand",
    "name": "{{ product.vendor | default: shop.name }}"
  },{% if reviewCount > 0 %}
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "{{ reviewRating }}",
    "reviewCount": "{{ reviewCount }}"
  },{% endif %}
  "sku": "{{ product.variants.first.sku }}",
  "offers": {
    "@type": "Offer",
    "priceCurrency": "{{ shop.currency }}",
    "price": "{{ product.variants.first.price | money_without_currency }}",
    "priceValidUntil": "2025-08-09",
    "availability": "http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
    "url": "{{ shop.url | append: product.url }}",
    "shippingDetails": [
      {
        "@type": "OfferShippingDetails",
        "description": "Free Shipping",
        "shippingRate": {
          "@type": "MonetaryAmount",
          "value": "0.00",
          "currency": "USD"
        },
        "eligibleTransactionVolume": {
          "@type": "PriceSpecification",
          "price": "50.00",
          "priceCurrency": "USD"
        },
        "shippingDestination": {
          "@type": "DefinedRegion",
          "addressCountry": "US"
        },
        "deliveryTime": "Typical delivery time: 3-5 business days" 
      },
      {
        "@type": "OfferShippingDetails",
        "description": "Standard shipping (0$-20$ orders)",
        "shippingRate": {
          "@type": "MonetaryAmount",
          "value": "6.00",
          "currency": "USD"
        },
        "eligibleTransactionVolume": {
          "@type": "PriceSpecification",
          "price": "0.00",
          "priceCurrency": "USD"
        },
        "shippingDestination": {
          "@type": "DefinedRegion",
          "addressCountry": "US"
        },
        "deliveryTime": "Typical delivery time: 3-5 business days" 
      },
      {
        "@type": "OfferShippingDetails",
        "description": "Standard shipping (20$-40$ orders)",
        "shippingRate": {
          "@type": "MonetaryAmount",
          "value": "8.00",
          "currency": "USD"
        },
        "eligibleTransactionVolume": {
          "@type": "PriceSpecification",
          "price": "20.01",
          "priceCurrency": "USD"
        },
        "shippingDestination": {
          "@type": "DefinedRegion",
          "addressCountry": "US"
        },
        "deliveryTime": "Typical delivery time: 3-5 business days" 
      },
      {
        "@type": "OfferShippingDetails",
        "description": "Standard shipping (40$-50$ orders)",
        "shippingRate": {
          "@type": "MonetaryAmount",
          "value": "10.00",
          "currency": "USD"
        },
        "eligibleTransactionVolume": {
          "@type": "PriceSpecification",
          "price": "40.01",
          "priceCurrency": "USD"
        },
        "shippingDestination": {
          "@type": "DefinedRegion",
          "addressCountry": "US"
        },
        "deliveryTime": "Typical delivery time: 3-5 business days" 
      }
    ],
    "hasMerchantReturnPolicy": {
      "@type": "MerchantReturnPolicy",
      "returnPolicyCategory": "NoReturns",
      "applicableCountry": "US",
      "merchantReturnLink": "{{ shop.url }}/pages/return-policy"
    }
  }
}
</script>
